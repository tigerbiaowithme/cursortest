# 环境变量配置修正说明

## ⚠️ 发现的问题

您的环境变量配置中有几个需要修正的地方：

---

## 问题 1：MONGODB_URI 格式错误

### 当前配置（错误）：
```
MONGODB_URI = mongodb+srv://devos:3N-QDbcSfrFL36j@cluster0.d59f1m2.mongodb.net/devos?appName=Cluster0
```

### 问题：
1. ❌ 等号前后有空格：`MONGODB_URI = ` 应该是 `MONGODB_URI=`
2. ❌ 集群地址错误：`d59f1m2` 应该是 `d59flm2`（字母 l，不是数字 1）

### 正确配置：
```
MONGODB_URI=mongodb+srv://devos:3N-QDbcSfrFL36j@cluster0.d59flm2.mongodb.net/devos?appName=Cluster0
```

---

## 问题 2：NODE_ENV 值错误

### 当前配置（错误）：
```
NODE_ENV=development
```

### 问题：
- ❌ 生产环境应该使用 `production`，不是 `development`

### 正确配置：
```
NODE_ENV=production
```

---

## 问题 3：NIXPACKS_NODE_VERSION（可选）

### 当前配置：
```
NIXPACKS_NODE_VERSION=22
```

### 说明：
- ✅ 这个变量通常由 Nixpacks 自动检测，不需要手动设置
- ✅ 如果设置了 Node.js 22，需要确保项目兼容此版本
- ⚠️ 可以删除这个变量，让 Nixpacks 自动检测

---

## ✅ 正确的环境变量配置（最终版本）

### Production Environment Variables（生产环境变量）：

```
MONGODB_URI=mongodb+srv://devos:3N-QDbcSfrFL36j@cluster0.d59flm2.mongodb.net/devos?appName=Cluster0
JWT_SECRET=dasdasdasfadsfdsafdasf
NODE_ENV=production
```

**说明：**
- `MONGODB_URI`：修正了格式和集群地址
- `JWT_SECRET`：保持您当前的值
- `NODE_ENV`：改为 `production`
- `NIXPACKS_NODE_VERSION`：可以删除（让 Nixpacks 自动检测）

---

## 📝 修正步骤

### 方法一：编辑文本区域（推荐）

1. 在 "Production Environment Variables" 文本区域中
2. 删除所有内容
3. 复制粘贴以下内容（确保没有多余空格）：

```
MONGODB_URI=mongodb+srv://devos:3N-QDbcSfrFL36j@cluster0.d59flm2.mongodb.net/devos?appName=Cluster0
JWT_SECRET=dasdasdasfadsfdsafdasf
NODE_ENV=production
```

4. 在 "Preview Deployments Environment Variables" 文本区域中也做同样的修改
5. 保存更改

### 方法二：使用 "+ Add" 按钮（如果支持）

1. 删除现有的错误配置
2. 使用 "+ Add" 按钮逐个添加正确的变量

---

## ⚠️ 重要提示

### 格式要求：
- ✅ 每行一个变量
- ✅ 格式：`变量名=变量值`（等号前后不能有空格）
- ✅ 变量值中不能有换行

### 错误的格式示例：
```
MONGODB_URI = value          ❌ 等号前后有空格
MONGODB_URI= value           ❌ 等号后有多余空格
MONGODB_URI =value           ❌ 等号前有多余空格
```

### 正确的格式示例：
```
MONGODB_URI=value            ✅ 正确
MONGODB_URI=value with space ✅ 正确（值中有空格也可以）
```

---

## 🔍 验证配置

修正后，您的环境变量应该看起来像这样：

```
MONGODB_URI=mongodb+srv://devos:3N-QDbcSfrFL36j@cluster0.d59flm2.mongodb.net/devos?appName=Cluster0
JWT_SECRET=dasdasdasfadsfdsafdasf
NODE_ENV=production
```

**检查要点：**
- ✅ 每行只有一个等号
- ✅ 等号前后没有空格
- ✅ 集群地址是 `d59flm2`（字母 l）
- ✅ `NODE_ENV` 是 `production`

---

## 🚀 下一步

修正环境变量后：

1. ✅ 保存配置
2. ✅ 返回应用页面
3. ✅ 触发部署（如果是首次部署，点击 "Deploy" 按钮）
4. ✅ 查看部署日志，确认环境变量正确加载

---

## 📚 参考

详细的环境变量说明请参考：[Coolify部署完整指南.md](./Coolify部署完整指南.md)
